<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>
Secret Structure - Librevault
</title>

	<!-- Favicons -->
	<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
	<link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
	<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
	<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
	<link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
	<link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
	<link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
	<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
	<link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
	<link rel="icon" type="image/png" href="/favicon-194x194.png" sizes="194x194">
	<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
	<link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
	<link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
	<link rel="manifest" href="/manifest.json">
	<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#1597dd">
	<meta name="apple-mobile-web-app-title" content="Librevault">
	<meta name="application-name" content="Librevault">
	<meta name="msapplication-TileColor" content="#1597dd">
	<meta name="msapplication-TileImage" content="/mstile-144x144.png">
	<meta name="theme-color" content="#1597dd">

	<meta name="description" content="Open source zero-knowledge peer-2-peer file sync designed with privacy in mind.">

	<!-- Google Analytics -->
<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
				(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-62723482-1', 'auto');
	ga('send', 'pageview');
</script>
	<!-- Yandex.Metrika counter -->
<script type="text/javascript">
	(function (d, w, c) {
		(w[c] = w[c] || []).push(function() {
			try {
				w.yaCounter30301270 = new Ya.Metrika({
					id:30301270,
					clickmap:true,
					trackLinks:true,
					accurateTrackBounce:true,
					webvisor:true,
					trackHash:true
				});
			} catch(e) { }
		});

		var n = d.getElementsByTagName("script")[0],
				s = d.createElement("script"),
				f = function () { n.parentNode.insertBefore(s, n); };
		s.type = "text/javascript";
		s.async = true;
		s.src = "https://mc.yandex.ru/metrika/watch.js";

		if (w.opera == "[object Opera]") {
			d.addEventListener("DOMContentLoaded", f, false);
		} else { f(); }
	})(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/30301270" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->
	<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Organization",
  "name" : "Librevault",
  "url" : "https://librevault.com",
  "sameAs" : [
    "https://twitter.com/librevault",
    "https://www.facebook.com/librevault",
    "https://vk.com/librevault",
    "https://plus.google.com/+Librevault",
    "https://www.linkedin.com/company/librevault",
    "https://www.instagram.com/librevault"
  ]
}
</script>

	<!-- Other things -->
	<link rel="stylesheet" type="text/css" href="/assets/css/styles.css" media="screen">
	<script src="//code.jquery.com/jquery-2.2.2.min.js" integrity="sha256-36cp2Co+/62rEAAYHLmRCPIych47CvdM+uTBJwSzWjI=" crossorigin="anonymous"></script>
</head>
<body>
<header class="header">
	<div class="wrapper header-wrap">
		<a href="https://librevault.com/" class="logo">
			<img src="/assets/img/librevault-logo.svg" alt="Librevault">
		</a>
		<nav class="header-nav">
			<ul>
				<li><a href="/blog/features">Features</a></li>
				<li><a href="/blog">Blog</a></li>
				<li><a href="https://forum.librevault.com/">Community</a></li>
			</ul>
			
			<a href="/download" class="button">Download</a>
			
		</nav>
	</div>
</header>
<section class="blog-post">
	<div class="wrapper">
		<article class="opened-post">
			<a href="/blog" class="back-link">&larr; Back to overview</a>
			<h1 class="post-title">Secret Structure</h1>
			<div class="date">May 22, 2016</div>
			<div class="content">
				<p>Secret is a key, used to identify sync folders, perform encryption and peer discovery.
<!-- more --></p>

<h2 id="general-secret-structure">General Secret structure</h2>

<p>Each Secret consists of four components:</p>

<style type="text/css" scoped="">
.secret-structure {
    border: 1px #ccc solid;
}
.secret-structure td {
    border: 1px #ccc solid;
    padding: 5px;
}
</style>

<table class="secret-structure">
<tr>
<td><b>Name</b></td>
<td>Secret type</td>
<td>Param</td>
<td>Payload</td>
<td>Checksum</td>
</tr>
<tr>
<td><b>Length</b></td>
<td>1</td>
<td>1</td>
<td>variable</td>
<td>1</td>
</tr>
</table>

<p>Secret may only contain Base58 characters, compatible with <a href="https://en.wikipedia.org/wiki/Base58">Bitcoin Base58 dictionary</a>:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz
</code></pre>
</div>

<h2 id="secret-type">Secret type</h2>
<p>The secret can be one of the following types:</p>

<ul>
  <li>A – Owner Secret. This Secret has read-write permissions. Generated by Librevault client.</li>
  <li>C – Read-only Secret. Can be derived from “A”-type Secret.</li>
  <li>D – Download-only Secret. It is capable only for exchanging and storing encrypted data. Cannot decrypt filenames, content or cryptographic metadata. Can be derived from “A” or “B” type Secret.</li>
</ul>

<h2 id="param">Param</h2>
<p>Param is a Base58 character, containing a reserved value, used by Librevault clients. It is intended to be used as an extension point in Secret. It may affect processing of Payload in some way and may have various meanings:</p>

<ul>
  <li>1 – no special meaning</li>
  <li>2–z – invalid value</li>
</ul>

<h2 id="checksum">Checksum</h2>
<p>Checksum is a check-character, computed using <a href="https://en.wikipedia.org/wiki/Luhn_mod_N_algorithm">Luhn mod 58 algorithm</a> using Base58 as a code-point mapping. It is computed from Base58-encoded Payload.</p>

<h2 id="payload">Payload</h2>
<p>Payload is a most comlicated part. It is encoded using Base58 algorithm and is dependent on Secret type and Param.
Base58-decoded payload (binary payload) contains:</p>

<ul>
  <li>Secret type <strong>A</strong> – Private key.</li>
  <li>Secret type <strong>C</strong> – Public key with Hash of the private key concatenated to it.</li>
  <li>Secret type <strong>D</strong> – Public key.</li>
</ul>

<p><strong>Public key crypto:</strong> ECC with <em>secp256r1</em> curve now, but we should consider switching to <em><a href="https://ed25519.cr.yp.to/">ed25519</a></em> instead (and using Param for distinguishing between them). EC Public keys are in compressed point form.</p>

<p><strong>Hash function:</strong> <a href="https://en.wikipedia.org/wiki/SHA-3">SHA-3</a>.</p>

<h2 id="folder-identifier">Folder identifier</h2>
<p>Clients use a special unique binary value to find each other over the network without leaking the key. It is computed as a hash value of public key (as in decoded Payload). The hash algorithm must be the same as the algorithm, used by Secret.
Folder identifier has no defined readable encoding and it is meant to be public and safe for publishing to trackers, the local network and the DHT,</p>

			</div>
			<div class="share">
				Share This!
				<script type="text/javascript" src="//yastatic.net/es5-shims/0.0.2/es5-shims.min.js" charset="utf-8"></script>
<script type="text/javascript" src="//yastatic.net/share2/share.js" charset="utf-8"></script>
<div class="ya-share2" data-lang="en" data-services="twitter,facebook,vkontakte,gplus,linkedin,reddit" data-counter=""></div>
			</div>
			
			<section>
				<h1>Comments</h1>
				

<script type="text/javascript">
      var disqus_shortname = 'librevault';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = '/blog/secret-structure';
        var disqus_url = 'https://librevault.com/blog/secret-structure/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


				<div id="disqus_thread" aria-live="polite">
					<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
				</div>
			</section>
			
		</article>
	</div>
</section>
<footer class="footer">
	<div class="wrapper">
		<div class="column">
			<h3>Librevault</h3>
			<nav>
				<ul>
					<li><a href="/blog/features">Features</a></li>
					<li><a href="/blog">Blog</a></li>
					<li><a href="https://forum.librevault.com/">Community</a></li>
					<li><a href="https://github.com/Librevault/librevault">Open Source</a></li>
					<li><a href="/download">Download</a></li>
				</ul>
			</nav>
		</div>
		<div class="column">
			<h3>Connect</h3>
			<nav>
				Subscribe to our newsletter
				<form class="subscribe-form" action="//librevault.us10.list-manage.com/subscribe/post?u=1524eff3d50bb8855bf6e22de&amp;id=7f46f7c998" method="post" target="_blank">
					<input type="email" name="EMAIL" placeholder="Enter your email"><input type="submit" name="subscribe" value="Subscribe">
				</form>
				<div class="social">
					<a href="https://twitter.com/librevault"><img src="/assets/img/social/Twitter%20Filled.png" alt="Twitter"></a>
					<a href="https://www.facebook.com/librevault"><img src="/assets/img/social/Facebook%20Filled.png" alt="Facebook"></a>
					<a href="https://vk.com/librevault"><img src="/assets/img/social/VKontakte%20Filled.png" alt="VKontakte"></a>
					<a href="https://plus.google.com/+librevault"><img src="/assets/img/social/Google%20Plus%20Filled.png" alt="Google+"></a>
					<a href="https://www.linkedin.com/company/librevault"><img src="/assets/img/social/LinkedIn%20Filled.png" alt="LinkedIn"></a>
				</div>
			</nav>
		</div>
	</div>
</footer>
<footer class="copyright-footer">
	<div class="wrapper">
		<div class="column">
			&copy; 2016 Librevault
		</div>
		<div class="column">
			Icons by <a href="https://icons8.com">Icons8</a>
		</div>
	</div>
</footer>
</body>
</html>